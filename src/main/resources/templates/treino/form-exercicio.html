<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="layout">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />     
     
    
</head>

<body>
	<!-- 	
	<h1 layout:fragment="header">
		<small>Formulário para cadastro dos exercícios <span class="glyphicon glyphicon-pencil"></span></small>
	</h1>
	 -->
	
<div layout:fragment="content">
	<form name="form" th:action="@{/salvar}" id="form" th:object="${treinoExercicio}">
	
	<div class="panel panel-default">
		<div class="panel panel-info">
			<div class="panel-heading"> <h4>Novo treino</h4></div>
		</div>
		<div class="panel-body">
			
				<div class="form-group">
			      <label for="titulo"><span><h4>Nome do treino</h4></span></label>
			      <input type="text" class="form-control" name="descricao" id="descricao" required="required" placeholder="Digite o nome do treino aqui..." th:field="*{treino.descricao}"> 	
			    </div>
			    <div class="form-group">
			      <label for="titulo"><span><h4>Data de vencimento</h4></span></label>
			      <input type="date" class="form-control" name="data" id="data"  required="required"  th:value="*{#calendars.format(treino.data, 'yyyy-MM-dd')}"> 	
			    </div>		
			    
			     
				<div id="myModal" class="modal fade" role="dialog">				
					<div class="modal-dialog">
					   <div class="modal-content">
							<div class="modal-header">
							   <button type="button" class="close" data-dismiss="modal">&times;</button>							   
							   <h4 class="modal-title">Exercícios</h4>
							   <div class="mensagem-aviso"></div>	
							 </div>					 
							 <div class="modal-body">
							 	<div class="form-row">
							 		<div class="form-group col-md-8">
								      <label for="titulo"><span><h4>Título do bloco</h4></span></label>
								      <select name="titulo" class="selectpicker form-control" id="titulo" required="required">
								       		<option th:each="t : ${titulos}" th:selected="${t.id == treinoExercicio.titulo.id}" th:value="${t.id}" th:text="${t.descricao}">DIA1</option>			       		
								   	  </select>
								    </div>
								</div>
								<div class="form-row">
								    <div class="form-group col-md-8">
										 <select name="exercicios" th:field="*{exercicio}" class="form-control" id="exercicios">									 	 
										        <option th:each="exercicio : ${exercicios}" th:value="${exercicio.id}" th:text="${exercicio.descricao}">Alabama</option>										        									      								    
									    </select>
									</div>									
								</div>
					  		</div>			  						 	
					  		
							<div class="modal-footer">
								<button type="submit" class="btn btn-info btn-md" id="salvar">Salvar</button>
							</div>
					   </div>			   				   				   
					</div>	
				</div>		   
					
				 				
				
						<!--						
						<input type="hidden" name="codigoTreino" id="codigoTreino" th:if="${treino.id != null}" th:value="${treino.id}">						
						-->	
						<input type="hidden" name="treino.codigo" id="treino.codigo" th:field="*{treino.id}">
						<button type="button" class="btn btn-info btn-sm" id="voltar"> Voltar </button>
						<button type="button" class="btn btn-info btn-sm" id="adicionar">Adicionar exercício</button>
						<!-- <input id="_csrf_param" type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">-->
				
				
				   
	 	</div>
	</div>
</form>										
</div><!-- ./content -->	

<!-- JQuery -->	
<div layout:fragment="scripts">
	<script th:inline="javascript">
		jQuery(function(){		
			
			//var _csrf_param = $("#_csrf_param").attr("value");
			
			$("#voltar").on("click",function(){
				window.location.href ="/treinoeforma/treinos";
			});
			
			$("#titulo").on("change",function(){				
				console.log($(this).val());
			});
			
			
			$("#salvar").on("click",function(){				
				console.log($("#exercicios").val());
				/*
	        	$.ajax({
					url:'/gestao-academia/excluirAjax',
					data:{"exercicios":$("#exercicios").val()},
					type:'post',
					dataType:'html',
					success:function(data){						
						//$.alert('Dados excluídos com sucesso!');
					}
				});
	        	*/
			});
			
			$("#adicionar").on("click",function(){
				
				if ($("#descricao").val().trim() === ""){					
					$.alert({
					    title: 'Atenção:',
					    content: "Preencha o campo: \"Nome do Treino\"",
					    type:'blue',
					    icon: 'glyphicon glyphicon-info-sign',
					    theme: 'bootstrap', // 'material', 'bootstrap','supervan'
					    closeIcon: true
					});					
					return false;
				}
				
				if ($("#data").val().trim() === ""){					
					$.alert({
					    title: 'Atenção:',
					    content: "Preencha o campo: \"Data de vencimento\"",
					    type:'blue',
					    icon: 'glyphicon glyphicon-info-sign',
					    theme: 'bootstrap', // 'material', 'bootstrap','supervan'
					    closeIcon: true
					});					
					return false;
				}
				
				 $('select[multiple].active.3col').multiselect({
			            columns: 1,
			            placeholder: 'Selecionar...',
			            search: true,			            
			            searchOptions: {
			                'default': 'Click aqui para pesquisar...'
			            },			            
			            selectAll: false,
			            onOptionClick : function( element, option ){			            	
			            	console.log(option.checked);
			            }
			        });
				
				 $("#myModal").modal("show");
				 
			});
			
			/*
			var array1 = new Array();
			var arr = new Array();
			var array2 = new Array();
			var arr2 = new Array();
			
			Array.prototype.verifica = function(val){				
				var array = new Array();
				array['result'] = false;
				array['pos']= null;						
				for (i=0; i < this.length; i++){
					if (this[i] == val){						
						array['result'] = true;
						array['pos']=i;						
						break;						
					}
				}
				return array;
			}
			*/
				
			/*
			var	 table = $('#exercicioTable').DataTable({							
			 	responsive:true,
			 	destroy:true,
			 	pageLength:5,						 	
			 	language:{
			 		info:"De _START_ Ao _END_ Total registros: _TOTAL_",
			 		lengthMenu:     "Mostrar _MENU_ linhas abaixo",
			 		search:"Pesquisar",				 		
			 		paginate:{
			 			previous:"Anterior",
			 			next:"Próximo"
			 		}
			 	},			 	
		        ajax:{
		        	url:"/treinoeforma/listaExercicioXHR",
		        	data:{
		        		'pCodigoTreino':$("#codigoTreino").val(),
		        		'pTitulo':$("#titulo option:selected").text()
		        		},
		        	dataSrc:""	        		
		        },
		        columns:[
		        		{data:"id"},
		            	{data:"descricao"},
		            	{data:"grupoMuscular.nome"}
		        ],
		        columnDefs: [{
		           targets: 0,
		           searchable: false,
		           orderable: false,
		           width: '1%',
		           className: 'dt-body-center',
		           render: function (data, type, full, meta){				        	   
		        	   if (type == 'display')
		        	   		var resp =$("#codigosSelecionados").val().indexOf(data) != -1 ? 'checked':'';
		        	   return "<a href='#' id='"+data+"'><input type='checkbox'  " + resp + "  value='"+data+"'>";
		           }
		        }]
		});
			*/
					 
			
			/*
			$('#exercicioTable tbody').on('click','a',function () {					 
				
				var item = $(this).attr("id");
				var table = $('#exercicioTable').DataTable();
				var id = table.row($(this).parents('tr')).data().id;
				 		
				if ($.trim($("#codigosSelecionados").val()) === ""){
					$("#codigosSelecionados").val(id);
					console.log($("#codigosSelecionados").val());
				}
				else
				{
					var codigos = $("#codigosSelecionados").val();
					array1 = codigos.split(',');								
					arr = array1.verifica(id);
					
					if (arr['result']){					
						array1.splice(arr['pos'],1);
						array1.sort();
						var lista = array1.join();
						$("#codigosSelecionados").val(lista);
						console.log($("#codigosSelecionados").val());
					}
					else
					{					
						array1.push(id);
						array1.sort();
						var lista = array1.join();
						$("#codigosSelecionados").val(lista);
						console.log($("#codigosSelecionados").val());
						
					}			
				}
				*/
				
				/*
				if ($(this).find("input:checkbox").is(":checked")){
					
					if ($.trim($("#codigosParaExclusao").val()) === ""){
						$("#codigosParaExclusao").val(id);
						console.log($("#codigosParaExclusao").val());
					}
					else
					{
						var codigos2 = $("#codigosParaExclusao").val();
						array2 = codigos2.split(',');
						arr2 = array2.verifica(id);
											
						if (arr2['result']){					
							array2.splice(arr2['pos'],1);
							array2.sort();
							var lista2 = array2.join();
							$("#codigosParaExclusao").val(lista2);
							console.log($("#codigosParaExclusao").val());
						}
					}
							
				}else{					
					array2.push(id);
					array2.sort();
					var lista2 = array2.join();
					$("#codigosParaExclusao").val(lista2);
					console.log($("#codigosParaExclusao").val());
					
				}
				
				
					    
			});		
			*/
		});			
	</script>
</div><!-- fim div script -->
	
</body> 
</html> 
   		